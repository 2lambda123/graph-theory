# Epidemic Outbreak

Recently there has been an epidemic outbreak in Asia. As a data scientist, I keep wondering why it is so difficult to develop a new vaccine and contain the virus. Challenges on Kaggle such as identifying rare animal species are beneficial for both participants and scientific research organizations behind it. Those big pharmaceutical companies may be able to break down big problems into small chunks and outsource to the data science crowd for free. We, data scientists not Messiah, cannot rescue Koala from Australian bushfire or identify the potential Ebola infected in West Africa. And the data, the asset we value the most, leaves a heavy carbon footprint on the planet (because of the server). Yet, crunching number to help the humanity is the least if not the only we can offer. Most of us just pour all our resources to beat S&P500 by several decimals or improve facial recognition on the minority. Where is the overhyped AI now?

While I was searching for k core graph in my university material, I discovered a module I have never taken called epidemic spreading on complex network. It suddenly struck me that we could apply graph theory to construct an agent-based model. The model would be able to simulate the epidemic outbreak and forecast the potential infected number. That was the least I could contribute. This project started there.

### Gompertz Curve

Before moving onto a random graph, I took a naïve approach to predict the final death toll of novel corona virus by <a href=https://en.wikipedia.org/wiki/Gompertz_function>Gompertz curve</a>. The idea was inspired by an <a href=https://wwwnc.cdc.gov/eid/content/10/6/pdfs/v10-n6.pdf>article</a> on U.S. Centre of Disease Control journal (Emerging Infectious Diseases Vol. 10, No. 6, June 2004, Page 1165). The researchers intended to study the effectiveness of intervention measures during SARS pandemic in 2003. They chose <a href=https://en.wikipedia.org/wiki/Generalised_logistic_function>Richard’s curve</a> (which is a generalized logistic model) of different training data horizon to predict the potential result. Thus, the first step of this project was to replicate the similar result for SARS in 2003. Instead of Richard’s curve, the model took Gompertz curve, a special form of generalized logistic model. Gompertz was designed to study the population in a confined space, which makes it also applicable to examine the spread of a disease.

The data came from <a href=https://www.who.int/csr/sars/country/en>WHO official website</a>. The full script of web scraping and ETL is attached. I have to make a complaint on how inconsistent the format of WHO report is. I probably spent 10 minutes to set up the web scraper and another 30 minutes to design the model and the figure. The data cleansing alone took me several hours. You are free to use the clean spreadsheet as long as you mention it comes from my hours of sweating and swearing.

Initially we look at the cumulated number of cases reported by WHO. The biggest challenge of the model is the data quality (like all the other data science problems). Due to various reasons (cover up, fake number), we exclude China to represent the global impact. We have observed some small bumps and spikes from the actual curve (thanks to Taiwan and U.S.). They are most likely caused by false positive and false negative. Unfortunately, WHO didn’t revise their old numbers after the publish. The retract of cumulated number is really unacceptable.

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-sars-exclude%20china-cumulative%20number%20of%20cases.png)

The figures of Hong Kong and Singapore demonstrate a perfect logistic curve. We have to praise the high-quality data provided by these two city states (crown jewels of Asia). The figures also show the early stage of forecast is perhaps overestimated. The result generated by first 30% or 40% training data is way too high. Two reasons could contribute to the phenomenon. One is the exponential growth rate of early stage. It may sound a bit counter intuitive. Gompertz curve is supposed to a slow start, rapid middle and slow ending. However, governments don’t normally report zero cases to WHO or WHO doesn’t include zero cases. If you look at the first report of WHO, it was issued on March 17th where both Hong Kong and Singapore have more than one case. We may never be able to detect the real early stage. The second reason could be the governments vowed to contain the virus with whatever it took after the initial outbreak. The effect of border seal, immigration check and patient quarantine kicked in. It slowed down the exponential growth rate. The saturation point of the curve shifted downwards accordingly. I sincerely hope it’s the latter reason or a mix of both. We still haven’t found out what really drove the virus away. The hypothesis of heat doesn’t hold as the winter of Singapore is still above 28 Celsius degrees.

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-sars-hong%20kong-cumulative%20number%20of%20cases.png)

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-sars-singapore-cumulative%20number%20of%20cases.png)

There are strange cases where the early stage estimation turns out to be optimistic. For Canada, the government changed the definition of infection on May 30th, 2003 which led to a second hike. Pour la France, je ne sais pas ce qui s’est passé, ça a été très rapide. :joy: 

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-sars-canada-cumulative%20number%20of%20cases.png)

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-sars-france-cumulative%20number%20of%20cases.png)

Let’s turn to the final death toll. The similar pattern from the previous cases exists as well.

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-sars-exclude%20china-number%20of%20deaths.png)

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-sars-hong%20kong-number%20of%20deaths.png)

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-sars-singapore-number%20of%20deaths.png)

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-sars-canada-number%20of%20deaths.png)

Now that we have showed the model is valid, the same methodology will be used to produce an early forecast for the novel corona virus. The data is still collected from <a href= https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports>WHO situation reports</a>. The format is even worse this time as the data is inside pdf files. Apart from manually copying the data, there is no shortcut. You are still free to use the aggregated data as long as you give me enough credits. 
Looking at the model, the global infection number may reach to **58K**!! That’s why they say the novel corona virus is more contagious than SARS. Given 39 days, it is going to reach 95% maximum infection number which is about 56K. Please take notice of that the 95% maximum doesn’t imply 95% quantile. I just assume 95% maximum is where the curve exits its exponential growth rate.

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-corona-total-confirmed%20cases.png)

Based upon the model, the impact on U.S. or Hong Kong or Taiwan seems quite limited (very skeptical on that). The impact on Singapore is going to be severe. But I am pretty sure Singapore will manage to change the course.

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-corona-united%20states%20of%20america-confirmed%20cases.png)

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-corona-hong%20kong-confirmed%20cases.png)

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-corona-singapore-confirmed%20cases.png)

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-corona-taiwan-confirmed%20cases.png)

Currently death only occurs in China. The ultimate death toll in China might be 1280, which is higher than SARS. In proportion to the infection number, estimated case fatality rate is 2% respectively, much lower than SARS. In about 43 days, the whole situation is supposed to quiet down. Let’s pray for those poor souls.

![alt text](https://github.com/je-suis-tm/graph-theory/blob/master/Epidemic%20Outbreak%20project/preview/gompertz-corona-china-number%20of%20deaths.png)

In general, this is an early stage pessimistic estimation. Please take it with a grain of salt. So far, I have only managed to obtain 11 available data points from WHO. The model on some of the countries (e.g. Australia, France, Japan) do not even converge. In reality, 90% of the models fail miserably. There is no need to panic from the model projection or take comfort in the low mortality. One thing we should learn from the model? Carpe diem.


